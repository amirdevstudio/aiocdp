# DO NOT EDIT THIS FILE
#
# This file is generated by the generator. To make changes, edit the generator
# and run it again.

from cdp.domains.base import (
    BaseDomain
)
from dataclasses import (
    dataclass
)
from cdp.utils import (
    is_defined,
    UNDEFINED
)
from typing import (
    TYPE_CHECKING
)
from cdp.domains.mapper import (
    from_dict
)
from cdp.domains.web_authn.types import (
    AddVirtualAuthenticatorReturnT,
    AuthenticatorId,
    Credential,
    GetCredentialReturnT,
    GetCredentialsReturnT,
    VirtualAuthenticatorOptions
)
if TYPE_CHECKING:
    from cdp.target.connection import (
        IResponse
    )


@dataclass
class WebAuthn(BaseDomain):
    def enable(
            self,
            enable_ui: bool = UNDEFINED
    ) -> IResponse[None]:
        params = {}

        if is_defined(enable_ui):
            params['enableUI'] = enable_ui

        return self._send_command(
            'WebAuthn.enable',
            params,
            False
        )

    def disable(
            self
    ) -> IResponse[None]:
        params = {}

        return self._send_command(
            'WebAuthn.disable',
            params,
            False
        )

    def add_virtual_authenticator(
            self,
            options: VirtualAuthenticatorOptions
    ) -> IResponse['AddVirtualAuthenticatorReturnT']:
        params = {
            'options': options,
        }

        return self._send_command(
            'WebAuthn.addVirtualAuthenticator',
            params,
            True,
            lambda data: from_dict(
                AddVirtualAuthenticatorReturnT,
                data,
                'camel'
            )
        )

    def set_response_override_bits(
            self,
            authenticator_id: AuthenticatorId,
            is_bogus_signature: bool = UNDEFINED,
            is_bad_uv: bool = UNDEFINED,
            is_bad_up: bool = UNDEFINED
    ) -> IResponse[None]:
        params = {
            'authenticatorId': authenticator_id,
        }

        if is_defined(is_bogus_signature):
            params['isBogusSignature'] = is_bogus_signature

        if is_defined(is_bad_uv):
            params['isBadUV'] = is_bad_uv

        if is_defined(is_bad_up):
            params['isBadUP'] = is_bad_up

        return self._send_command(
            'WebAuthn.setResponseOverrideBits',
            params,
            False
        )

    def remove_virtual_authenticator(
            self,
            authenticator_id: AuthenticatorId
    ) -> IResponse[None]:
        params = {
            'authenticatorId': authenticator_id,
        }

        return self._send_command(
            'WebAuthn.removeVirtualAuthenticator',
            params,
            False
        )

    def add_credential(
            self,
            authenticator_id: AuthenticatorId,
            credential: Credential
    ) -> IResponse[None]:
        params = {
            'authenticatorId': authenticator_id,
            'credential': credential,
        }

        return self._send_command(
            'WebAuthn.addCredential',
            params,
            False
        )

    def get_credential(
            self,
            authenticator_id: AuthenticatorId,
            credential_id: str
    ) -> IResponse['GetCredentialReturnT']:
        params = {
            'authenticatorId': authenticator_id,
            'credentialId': credential_id,
        }

        return self._send_command(
            'WebAuthn.getCredential',
            params,
            True,
            lambda data: from_dict(
                GetCredentialReturnT,
                data,
                'camel'
            )
        )

    def get_credentials(
            self,
            authenticator_id: AuthenticatorId
    ) -> IResponse['GetCredentialsReturnT']:
        params = {
            'authenticatorId': authenticator_id,
        }

        return self._send_command(
            'WebAuthn.getCredentials',
            params,
            True,
            lambda data: from_dict(
                GetCredentialsReturnT,
                data,
                'camel'
            )
        )

    def remove_credential(
            self,
            authenticator_id: AuthenticatorId,
            credential_id: str
    ) -> IResponse[None]:
        params = {
            'authenticatorId': authenticator_id,
            'credentialId': credential_id,
        }

        return self._send_command(
            'WebAuthn.removeCredential',
            params,
            False
        )

    def clear_credentials(
            self,
            authenticator_id: AuthenticatorId
    ) -> IResponse[None]:
        params = {
            'authenticatorId': authenticator_id,
        }

        return self._send_command(
            'WebAuthn.clearCredentials',
            params,
            False
        )

    def set_user_verified(
            self,
            authenticator_id: AuthenticatorId,
            is_user_verified: bool
    ) -> IResponse[None]:
        params = {
            'authenticatorId': authenticator_id,
            'isUserVerified': is_user_verified,
        }

        return self._send_command(
            'WebAuthn.setUserVerified',
            params,
            False
        )

    def set_automatic_presence_simulation(
            self,
            authenticator_id: AuthenticatorId,
            enabled: bool
    ) -> IResponse[None]:
        params = {
            'authenticatorId': authenticator_id,
            'enabled': enabled,
        }

        return self._send_command(
            'WebAuthn.setAutomaticPresenceSimulation',
            params,
            False
        )
